def solve_problem1_optimized():
    with open("inputs/problem1_input.txt") as f:
        lines = [line.strip() for line in f]

    # Split grid and directions in one pass
    split_index = lines.index("")
    grid = [list(row) for row in lines[:split_index]]
    directions = lines[split_index + 1].split()

    # Single optimized rotate function
    def rotate(row, steps):
        steps %= len(row)
        return row[steps:] + row[:steps]

    # Apply rotations
    for i, d in enumerate(directions):
        amount = int(d[1:])
        if d[0] == "L":
            grid[i] = rotate(grid[i], amount)
        else:
            grid[i] = rotate(grid[i], -amount)

    # Middle row ASCII sum
   
    mid_row = grid[len(grid) // 2]
    ascii_sum = sum(map(ord, mid_row))

    print(ascii_sum)
    return ascii_sum


if __name__ == "_main_":
    solve_problem1_optimized()